#!/bin/bash

echo "๐ ูุตุจ ุฑุจุงุช ุชูฺฏุฑุงู ุชุงุณ ุฏู ููุฑู ุฏุฑ ุญุงู ุงุฌุฑุงุณุช..."

# ฺฏุฑูุชู ุงุทูุงุนุงุช ุงุฒ ฺฉุงุฑุจุฑ
read -p "๐ ูุทูุงู ุชูฺฉู ุฑุจุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ: " BOT_TOKEN
read -p "๐ ูุทูุงู ุขุฏ ุนุฏุฏ ุงุฏูู ุฑุง ูุงุฑุฏ ฺฉูุฏ: " ADMIN_ID

# ุจุฑูุฒุฑุณุงู ู ูุตุจ ูพุดโูุงุฒูุง
echo "๐ ุฏุฑ ุญุงู ุจุฑูุฒุฑุณุงู ุณุณุชู ู ูุตุจ ูพุดโูุงุฒูุง..."
sudo apt update && sudo apt upgrade -y
sudo apt install -y python3 python3-pip

# ูุตุจ ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ
echo "๐ฆ ุฏุฑ ุญุงู ูุตุจ ฺฉุชุงุจุฎุงููโูุง ูพุงุชูู..."
pip3 install python-telegram-bot --upgrade

# ฺฉููู ฺฉุฑุฏู ุง ุจุฑูุฒุฑุณุงู ุณูุฑุณ ฺฉุฏ ุงุฒ ฺฏุชโูุงุจ
if [ -d "telegram-dice-bot" ]; then
    echo "๐ ุจุฑูุฒุฑุณุงู ุณูุฑุณ ฺฉุฏ..."
    cd telegram-dice-bot && git pull
else
    echo "๐ฅ ุฏุฑุงูุช ุณูุฑุณ ฺฉุฏ ุงุฒ ฺฏุชโูุงุจ..."
    git clone https://github.com/jasemhooti/telegram-dice-bot.git
    cd telegram-dice-bot
fi

# ุงุฌุงุฏ ูุงู .env ุจุฑุง ุฐุฎุฑู ุงุทูุงุนุงุช ุญุณุงุณ
echo "๐ ุฐุฎุฑู ุชูฺฉู ู ุขุฏ ุงุฏูู..."
echo "BOT_TOKEN=$BOT_TOKEN" > .env
echo "ADMIN_ID=$ADMIN_ID" >> .env

# ุงุฌุฑุง ุฑุจุงุช
echo "๐ ุงุฌุฑุง ุฑุจุงุช..."
nohup python3 bot.py &

echo "โ ุฑุจุงุช ุจุง ููููุช ูุตุจ ู ุงุฌุฑุง ุดุฏ!"
echo "ุจุฑุง ุฏุฏู ูุงฺฏโูุง ุฑุจุงุช ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:"
echo "tail -f nohup.out"
